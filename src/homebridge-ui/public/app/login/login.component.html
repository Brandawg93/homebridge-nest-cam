<p class="help-block"><strong>Note: </strong>This plugin only works with Google accounts. Please visit this <a target="_blank" href="https://nest.com/whats-happening/">blog post</a> for more info.</p>
<div @opacity *ngIf="!waiting">
    <div>
        <ol>
            <li>Click <a href="{{token.url}}" target="_blank" rel="noopener noreferrer">HERE</a> to open the Nest login page.</li>
            <li>Open Developer Tools (View/Developer/Developer Tools).</li>
            <li>Click on <code>Network</code> tab. Make sure <code>Preserve Log</code> is checked.</li>
            <li>In the <code>Filter</code> box, enter <code>nest-account</code> and select <code>Doc</code> for the filter type.</li>
            <li>Login to your Google account.</li>
            <li>After a few seconds you will be redirected back to Google.</li>
            <li>Click on the call in red beginning with <code>nest-account&authuser=...</code></li>
            <li>Copy and paste the entire Request Url (beginning with <code>com.googleusercontent.apps</code>) below: </li>
        </ol>
        <div [formGroup]="form">
            <div class="schema-form-text form-group">
                <label class="control-label">Request URL <strong class="text-danger">*</strong></label>
                <input type="text" class="form-control" formControlName="requestUrl" />
            </div>
            <div class="text-center">
                <button type="button" class="btn btn-primary" [disabled]="!form?.valid" (click)="doLogin()">Log In</button>
            </div>
        </div>
    </div>    
</div>
<div @opacity *ngIf="waiting">
    <div class="text-center">
        <progress-bar [progress]="progress" [color]="color"></progress-bar>
        <div>
            <p>Loggin in. Please wait...</p>
        </div>
        <p class="text-danger">{{errMsg}}</p>
        <button class="btn btn-danger" (click)="restart()">Restart <i class="fas fa-undo-alt"></i></button>
    </div>
</div>